<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Distribuir Atributos</title>
</head>
<body>
    <h1>Distribua seus Atributos</h1>
    <p>Valores rolados: {{ valores }}</p>

    <form method="POST" action="{{ url_for('distribuir_atributos') }}">
        {% for attr in atributos %}
            <label>{{ attr }}:</label>
            <select name="{{ attr }}" class="atributo-select" required>
                <option value="">-- escolha --</option>
                {% for v in valores %}
                    <option value="{{ v }}">{{ v }}</option>
                {% endfor %}
            </select><br><br>
        {% endfor %}
        <button type="submit">Finalizar Personagem</button>
    </form>

    <script>
        const selects = document.querySelectorAll(".atributo-select");

        function atualizarOpcoes() {
            // Coleta todos os valores já escolhidos
            let usados = Array.from(selects)
                              .map(sel => sel.value)
                              .filter(v => v !== "");

            // Para cada select, refaz as opções
            selects.forEach(sel => {
                const valorAtual = sel.value;
                for (let opt of sel.options) {
                    if (opt.value === "" || opt.value === valorAtual) {
                        opt.disabled = false; // sempre habilita opção vazia ou a atual
                    } else if (usados.includes(opt.value)) {
                        opt.disabled = true; // desabilita se já usado em outro lugar
                    } else {
                        opt.disabled = false; // habilita se ainda não usado
                    }
                }
            });
        }

        // Ativa para cada mudança
        selects.forEach(sel => sel.addEventListener("change", atualizarOpcoes));

        // Executa na primeira vez
        atualizarOpcoes();
    </script>
</body>
</html>
